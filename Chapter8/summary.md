# 异常控制流 #

1. 现代系统通过使控制流发生突变来对这些情况做出反应。一般而言，我们把这些突变称为**异常控制流**。异常控制流发生在计算机系统的各个层次。

## 异常 ##

1. 在处理器中，状态被编码为不同的位和信号。状态变化称为事件。事件可能和当前指令的执行直接相关。也可能和当前指令的执行没有关系。

2. 在任何情况下，当处理器检测到有事件发生时，它就会通过一张叫做**异常表**的跳转表，进行一个间接过程调用（异常），到一个专门设计用来处理这类事件的操作系统子程序（异常处理程序）。

3. 系统中可能的每种类型的异常都分配了一个唯一的非负整数的异常号。其中一些号码是由处理器的设计者分配的，其他号码是由操作系统内核的设计者分配的。在系统启动时，由操作系统分配和初始化的异常表表目k（异常号）包含异常k的处理程序的地址。

4. 异常区别于过程调用的地方：
    - 根据异常的类型，返回地址要么时当前指令，要么是下一条指令。
    - 处理器也把一些额外的处理器状态压到栈里。
    - 如果控制从用户程序转移到内核，所有这些项目都被压到内核栈中。
    - 异常处理程序运行在内核模式下，对所有的系统资源都有完全的访问权限。

5. 异常的分类：
    |类别|原因|异步/同步|返回行为|
    |---|---|---|---|
    |中断|来自I/O设备的信号|异步|总是返回到下一条指令|
    |陷阱|有意的异常|同步|总是返回到下一条指令|
    |故障|潜在可恢复的错误|同步|可能返回到当前指令|
    |终止|不可恢复的错误|同步|不会返回|
